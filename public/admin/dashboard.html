<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo - Decisiones Ciudadanas</title>
    <link rel="stylesheet" href="../assets/css/admin-dashboard.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-circle">DC</div>
                    <span class="app-name">Panel Administrativo</span>
                </div>
                


                <div class="user-section">
                    <div class="user-avatar">
                        <span id="adminInitials">AM</span>
                    </div>
                    <button class="user-menu-btn" onclick="toggleUserMenu()">
                        <span id="adminName">Admin Municipal</span>
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                            <path d="M3 4.5L6 7.5L9 4.5" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                    </button>
                    <div class="user-menu" id="adminUserMenu">
                        <a href="#" onclick="changePassword()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 1L3 5V11C3 16.55 6.84 21.74 12 23C17.16 21.74 21 16.55 21 11V5L12 1ZM12 7C13.1 7 14 7.9 14 9S13.1 11 12 11 10 10.1 10 9 10.9 7 12 7ZM12 17C10.33 17 8.94 16.16 8.21 14.89C8.38 13.63 10.92 13 12 13S15.62 13.63 15.79 14.89C15.06 16.16 13.67 17 12 17Z"/>
                            </svg>
                            Cambiar Contraseña
                        </a>
                        <a href="#" onclick="logout()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M16 17V14H9V10H16V7L21 12L16 17M14 2C15.11 2 16 2.9 16 4V6H14V4H5V20H14V18H16V20C16 21.11 15.11 22 14 22H5C3.9 22 3 21.11 3 20V4C3 2.9 3.9 2 5 2H14Z"/>
                            </svg>
                            Cerrar sesión
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="admin-main">
            <!-- Métricas principales -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                        </svg>
                    </div>
                    <div class="metric-info">
                        <h3>Total Propuestas</h3>
                        <div class="metric-value" id="totalPropuestas">0</div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                            <polyline points="22,4 12,14.01 9,11.01"/>
                        </svg>
                    </div>
                    <div class="metric-info">
                        <h3>Proyectos Completados</h3>
                        <div class="metric-value" id="proyectosCompletados">0</div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                        </svg>
                    </div>
                    <div class="metric-info">
                        <h3>Usuarios Activos</h3>
                        <div class="metric-value" id="usuariosActivos">0</div>
                    </div>
                </div>

                <div class="metric-card">
                    <div class="metric-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M7 10v12"/>
                            <path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/>
                        </svg>
                    </div>
                    <div class="metric-info">
                        <h3>Participación</h3>
                        <div class="metric-value" id="participacion">0%</div>
                    </div>
                </div>
            </div>

            <!-- Acciones Rápidas -->
            <div class="actions-section">
                <h2>Acciones Rápidas</h2>
                <p class="section-subtitle">Herramientas principales para la gestión de propuestas</p>
                
                <div class="quick-actions">
                    <button class="action-btn primary" onclick="crearNuevaPropuesta()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                        Crear nueva propuesta
                    </button>
                    
                    <button class="action-btn secondary" onclick="exportarDatos()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Exportar datos
                    </button>
                </div>
            </div>

            <!-- Gestión de Propuestas -->
            <div class="table-section">
                <div class="table-header">
                    <h2>Gestión de Propuestas</h2>
                    <div class="table-filters">
                        <select id="estadoFilterAdmin" class="filter-select">
                            <option value="">Todos los estados</option>
                            <option value="Pendiente">Pendiente</option>
                            <option value="En Revision">En Revisión</option>
                            <option value="Aprobada">Aprobada</option>
                            <option value="En Ejecucion">En Ejecución</option>
                            <option value="Completada">Completada</option>
                            <option value="Rechazada">Rechazada</option>
                        </select>
                    </div>
                </div>

                <div class="data-table-container">
                    <table class="data-table" id="propuestasTable">
                        <thead>
                            <tr>
                                <th>Título</th>
                                <th>Categoría</th>
                                <th>Barrio</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="propuestasTableBody">
                            <tr>
                                <td colspan="6" class="loading-row">Cargando propuestas...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal para cambiar estado -->
    <div id="estadoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cambiar Estado de Propuesta</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p><strong>Propuesta:</strong> <span id="modalPropuestaTitulo"></span></p>
                <div class="form-group">
                    <label for="nuevoEstado">Nuevo Estado:</label>
                    <select id="nuevoEstado" class="form-select">
                        <option value="Pendiente">Pendiente</option>
                        <option value="En Revision">En Revisión</option>
                        <option value="Aprobada">Aprobada</option>
                        <option value="En Ejecucion">En Ejecución</option>
                        <option value="Completada">Completada</option>
                        <option value="Rechazada">Rechazada</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button class="btn-primary" onclick="updateEstado()">Actualizar Estado</button>
            </div>
        </div>
    </div>

    <script src="../assets/js/admin-dashboard.js"></script>
</body>
</html>
